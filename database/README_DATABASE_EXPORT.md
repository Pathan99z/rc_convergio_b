# Database Export System

This system allows the team to avoid migration issues by using a pre-exported database dump instead of running migrations.

## 🎯 Problem Solved

- **Duplicate Migration Files**: Multiple `create_tasks_table.php`, `create_campaigns_table.php`, etc.
- **Team Synchronization**: Everyone gets the same database state
- **No Migration Conflicts**: Skip `php artisan migrate` entirely

## 📁 Files

- `export_database.ps1` - PowerShell script for Windows
- `export_database.sh` - Bash script for Linux/Mac
- `db_dump.sql` - The exported database (generated by scripts)

## 🚀 For Database Maintainers (You)

### Windows (PowerShell)
```powershell
# Basic export
.\database\export_database.ps1

# With custom parameters
.\database\export_database.ps1 -DatabaseName "rc_convergio_s" -Username "root" -Password "your_password"

# Using XAMPP path if mysqldump not in PATH
# First, add C:\xampp\mysql\bin to your PATH, then run:
.\database\export_database.ps1
```

### Linux/Mac (Bash)
```bash
# Make script executable (first time only)
chmod +x database/export_database.sh

# Basic export
./database/export_database.sh

# With custom parameters
./database/export_database.sh --database rc_convergio_s --username root --password your_password

# Show help
./database/export_database.sh --help
```

### After Export
```bash
# Commit the updated database dump
git add database/db_dump.sql
git commit -m "Update database dump - $(date)"
git push
```

## 👥 For Team Members

### Setup Process (One-time)
1. **Pull latest code**
   ```bash
   git pull origin main
   ```

2. **Create database in phpMyAdmin**
   - Open phpMyAdmin (http://localhost/phpmyadmin)
   - Create new database named `rc_convergio_s`
   - Character set: `utf8mb4_unicode_ci`

3. **Import database dump**
   - In phpMyAdmin, select the `rc_convergio_s` database
   - Click "Import" tab
   - Choose file: `database/db_dump.sql`
   - Click "Go"

4. **Configure Laravel**
   - Copy `.env.example` to `.env`
   - Set database configuration:
     ```env
     DB_CONNECTION=mysql
     DB_HOST=127.0.0.1
     DB_PORT=3306
     DB_DATABASE=rc_convergio_s
     DB_USERNAME=root
     DB_PASSWORD=
     ```

5. **Generate application key**
   ```bash
   php artisan key:generate
   ```

6. **Start development**
   ```bash
   php artisan serve
   ```

### When Database Updates
1. **Pull latest code**
   ```bash
   git pull origin main
   ```

2. **Check if db_dump.sql changed**
   ```bash
   git log --oneline database/db_dump.sql
   ```

3. **If changed, re-import**
   - Drop the `rc_convergio_s` database in phpMyAdmin
   - Recreate it
   - Import the new `database/db_dump.sql`

## 🔧 Troubleshooting

### mysqldump not found (Windows)
```powershell
# Add XAMPP MySQL to PATH temporarily
$env:PATH += ";C:\xampp\mysql\bin"
.\database\export_database.ps1

# Or use full path
C:\xampp\mysql\bin\mysqldump.exe --host=localhost --user=root rc_convergio_s > database/db_dump.sql
```

### Access Denied (MySQL)
```bash
# Check if MySQL is running
# XAMPP: Start MySQL service
# Linux: sudo systemctl start mysql

# Test connection
mysql -u root -p -h localhost
```

### Import Fails in phpMyAdmin
- **File too large**: Increase `upload_max_filesize` in php.ini
- **Timeout**: Increase `max_execution_time` in php.ini
- **Memory**: Increase `memory_limit` in php.ini

### Alternative Import Methods
```bash
# Command line import
mysql -u root -p rc_convergio_s < database/db_dump.sql

# Or with XAMPP
C:\xampp\mysql\bin\mysql.exe -u root -p rc_convergio_s < database/db_dump.sql
```

## 📋 Best Practices

### For Database Maintainers
- **Export regularly**: After major schema changes
- **Test the dump**: Import it on a clean environment
- **Include data**: Export with `--complete-insert` for consistent data
- **Version control**: Always commit database changes

### For Team Members
- **Never run migrations**: Use the dump instead
- **Check for updates**: Pull regularly for database changes
- **Backup before import**: If you have local data
- **Report issues**: If import fails, check the troubleshooting section

## 🔄 Workflow

1. **Developer makes schema changes**
2. **Runs migrations locally**
3. **Exports database using script**
4. **Commits and pushes db_dump.sql**
5. **Team pulls and imports new dump**
6. **No migration conflicts!**

## 📞 Support

If you encounter issues:
1. Check this README first
2. Try the troubleshooting steps
3. Ask the database maintainer for help
4. Check if your local environment matches the team's setup

---

**Note**: This system is designed to work with XAMPP on Windows and standard MySQL installations on Linux/Mac. Adjust paths and commands as needed for your specific setup.
